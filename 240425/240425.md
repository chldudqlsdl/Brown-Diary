# **67. Setting Up Table View**

<aside>
ğŸ’¡ **NSObjectì™€ UIWindow**

</aside>

### TableView ë¥¼ í•˜ë‚˜ ì„¸íŒ…

### ì´ TableView ë¥¼ ì•±ì˜ windowì— ì–¹ì„ ê²ƒ â†’ ì»¤ìŠ¤í…€ Present ë¥¼ ì´ë ‡ê²Œ í•œë‹¤!

- ì´ ì•±ì— ì—°ê²°ëœì”¬(connectedScenes) ì„ ê°€ì ¸ì™€ UIWindowScene ìœ¼ë¡œ ìºìŠ¤íŒ…
    - UIKitì€ ëŒ€ì²´ë¡œ Scene ì´ í•œê°œì´ê³  UIWindowSceneì´ë‹¤
- windowSceneì—ì„œ KeyWindowë¥¼ ë¦¬í„´
    - `first(where predicate: (Self.Element) **throws** -> Bool) **rethrows** -> Self.Element?` â†’ ì¡°ê±´ì„ ë„£ì–´ì£¼ë©´ ë°°ì—´ì—ì„œ ì²˜ìŒìœ¼ë¡œ ë§Œì¡±í•˜ëŠ” ë…€ì„ì„ ë¦¬í„´

```swift
guard let windowScene = UIApplication.shared.connectedScenes.first as? UIWindowScene else { return }
guard let window = windowScene.windows.first(where: { $0.isKeyWindow }) else { return }

window.addSubview(tableView)
tableView.frame = CGRect(x: 0, y: window.frame.height - 300, width: window.frame.width, height: 300)

self.window = window
```

### NSObject ì¸ ì´ìœ  ì¶”ì¸¡

- UIWindowë¥¼ ì†ì„±ìœ¼ë¡œ ê°€ì§€ê³  ìˆê³ , ìœ„ì—ì„œ ê°€ì ¸ì˜¨ ì•±ì˜ Windowë¥¼  ì´ í´ë˜ìŠ¤ì˜ ì†ì„±ì— í• ë‹¹í•˜ë ¤ê³ 
    - ê·¸ë˜ì„œ Class ì´ë¦„ì´ ActionSheetLauncher ë‹¤ ActionSheet ê°€ ì•„ë‹ˆê³ 

```swift
class ActionSheetLauncher: NSObject {
    
    // MARK: - Properties
    private let user: User
    private let tableView = UITableView()
    private var window: UIWindow?
}
```

# **68. Animating Table View / Fade View**

<aside>
ğŸ’¡ **ì•¡ì…˜ì‹œíŠ¸ì²˜ëŸ¼ ë³´ì´ë ¤ë©´ : ë°˜íˆ¬ëª… ê²€ì€ìƒ‰ ë’·ë°°ê²½ + Animation**

</aside>

### blackSheet

```swift
private lazy var blackView = UIView().then {
    $0.alpha = 0
    $0.backgroundColor = UIColor(white: 0, alpha: 0.5)
    let tap = UITapGestureRecognizer(target: self, action: #selector(handleDismissal))
    $0.addGestureRecognizer(tap)
}
```

### Animation

- blackView : íˆ¬ëª…ë„ 100 â†’ 0
- tablaView : y ì¢Œí‘œ ë§¨ì•„ë˜ â†’ ë§¨ì•„ë˜ - 300

```swift
func show() {
    guard let windowScene = UIApplication.shared.connectedScenes.first as? UIWindowScene else { return }
    guard let window = windowScene.windows.first(where: { $0.isKeyWindow }) else { return }
    
    window.addSubview(blackView)
    blackView.frame = window.frame
    
    window.addSubview(tableView)
    tableView.frame = CGRect(x: 0, y: window.frame.height, width: window.frame.width, height: 300)
    
    UIView.animate(withDuration: 0.5) {
        self.blackView.alpha = 1
        self.tableView.frame.origin.y -= 300
    }
}
```

### Dismiss : ë¶„í•´ëŠ” ì¡°ë¦½ì˜ ì—­ìˆœ

```swift
@objc func handleDismissal() {
    UIView.animate(withDuration: 0.5) {
        self.blackView.alpha = 0
        self.tableView.frame.origin.y += 300
    }
}
```

# **70. Action Sheet Data Model + View Model**

<aside>
ğŸ’¡ **ë¶„ê¸°ì²˜ë¦¬ì‹œì—ëŠ” ì£¼ë¡œ Enum ì„ ì‚¬ìš©í•˜ì‹ ë‹¤ + Enum ë°°ì—´**

</aside>

### ActionSheetOptions

```swift
enum ActionSheetOptions {
    case follow(User)
    case unfollow(User)
    case report
    case delete
    
    var description: String {
        switch self {
        case .follow(let user): return "Follow @\(user.username)"
        case .unfollow(let user): return "Unfollow @\(user.username)"
        case .report: return "Report Tweet"
        case .delete: return "Delete Tweet"
        }
    }
}
```

### ActionSheetViewModel

- ê²½ìš°ì˜ ìˆ˜ ë³„ë¡œ ActionSheetOptions ê°€ ë‹¤ë¥¸ë°, ê²½ìš°ë‹¹ ì˜µì…˜ì´ ì—¬ëŸ¬ê°œ í•„ìš”í•˜ê¸°ì— `[ActionSheetOptions]` ì‚¬ìš©

```swift
class ActionSheetViewModel {
    
    private let user: User
    
    var options: [ActionSheetOptions] {
    
        var results: [ActionSheetOptions] = []
        
        if user.isCurrentUser {
            results.append(.delete)
        } else {
            let followOption: ActionSheetOptions = user.isFollowed ? .unfollow(user) : .follow(user)
            results.append(followOption)
        }
        results.append(.report)
        return results
    }
    
    init(user: User) {
        self.user = user
    }
}
```

### ì ìš©

```swift
class ActionSheetLauncher: NSObject {
    private var user: User
    private lazy var viewModel = ActionSheetViewModel(user: user)
}

extension ActionSheetLauncher: UITableViewDataSource {
    func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -> Int {
        return viewModel.options.count
    }
    
    func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -> UITableViewCell {
        let cell = tableView.dequeueReusableCell(withIdentifier: reuseIdentifier, for: indexPath) as! ActionSheetCell
        cell.option = viewModel.options[indexPath.row]
        return cell
    }
}
```

d
