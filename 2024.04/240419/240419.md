# **38. Showing Profile Controller**

### íƒ­ ì œìŠ¤ì²˜ : í”„ë¡œí•„ ì´ë¯¸ì§€ í´ë¦­í•  ìˆ˜ ìˆê²Œ ë§Œë“¤ê¸°

- `lazy var` âˆ™ `isUserInteractionEnabled`

```swift
private lazy var profileImageView = UIImageView().then {
    let tapGesture = UITapGestureRecognizer(target: self, action: #selector(handleProfileImageTapped))
    $0.addGestureRecognizer(tapGesture)
    $0.isUserInteractionEnabled = true
}
```

### ì»¤ìŠ¤í…€ ë¸ë¦¬ê²Œì´íŠ¸ íŒ¨í„´ : ì…€ì˜ ë™ì‘ì„ ë¶€ëª¨ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ê°ì§€í•˜ëŠ” ë°©ë²•

- **í”„ë¡œí•„ ì´ë¯¸ì§€ë¥¼ í´ë¦­í–ˆì„ ë•Œ ë„¤ë¹„ê²Œì´ì…˜ ì´ë™ì„ í•´ì•¼í•˜ëŠ”ë°, ì´ëŠ” ë·°ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œë§Œ ê°€ëŠ¥í•˜ë¯€ë¡œ ì…€ì—ì„œ ì´ë¥¼ ê°ì§€í•˜ì—¬ ë·°ì»¨íŠ¸ë¡¤ëŸ¬ë¡œ ë³´ë‚´ì•¼í•œë‹¤**

```swift
// í”„ë¡œí† ì½œ ì„ ì–¸ - AnyObject í•´ì¤˜ì•¼ weak ê°€ëŠ¥
**protocol TweetCellDelegate: AnyObject {
    func handelProfileImageTapped()
}**

// TweetCell
**weak var delegate: TweetCellDelegate?**

@objc func handleProfileImageTapped() {
    **delegate?.handelProfileImageTapped()**
}

// FeedController 

extension FeedController {
    override func collectionView(_ collectionView: UICollectionView, cellForItemAt indexPath: IndexPath) -> UICollectionViewCell {
        let cell = collectionView.dequeueReusableCell(withReuseIdentifier: reuseIdentifier, for: indexPath) as! TweetCell
        **cell.delegate = self**
        return cell
    }
}
**extension FeedController: TweetCellDelegate {
    func handelProfileImageTapped() {
        let vc = ProfileController(collectionViewLayout: UICollectionViewFlowLayout())
        navigationController?.pushViewController(vc, animated: true)
    }
}**
```

# **39. Profile CollectionView Setup**

### ê¸°ì¡´ì²˜ëŸ¼ TweetCell ëª‡ê°œ ê¹”ì•„ì£¼ê³ 

### CollectionViewHeader ì„ ë§Œë“¤ì–´ ì£¼ì

- UICollectionReusableView

```swift
class ProfileHeader: UICollectionReusableView {
    override init(frame: CGRect) {
        super.init(frame: frame)
        backgroundColor = .red
    }
}
```

- Register

```swift
collectionView.register(ProfileHeader.self, forSupplementaryViewOfKind: 
            UICollectionView.elementKindSectionHeader, withReuseIdentifier: headerIdentifier)
```

- DataSource

```swift
extension ProfileController {
    override func collectionView(_ collectionView: UICollectionView, viewForSupplementaryElementOfKind kind: String, at indexPath: IndexPath) -> UICollectionReusableView {
        let header = collectionView.dequeueReusableSupplementaryView(ofKind: kind, withReuseIdentifier: headerIdentifier, for: indexPath)
        return header
    }
}
```

- Layout

```swift
extension ProfileController: UICollectionViewDelegateFlowLayout {
    func collectionView(_ collectionView: UICollectionView, layout collectionViewLayout: UICollectionViewLayout, referenceSizeForHeaderInSection section: Int) -> CGSize {
        return CGSize(width: view.frame.width, height: 300)
    }
}
```

- ìœ„ì— ë”± ë¶™ì´ê¸°

```swift
collectionView.contentInsetAdjustmentBehavior = .never
```

# **41. Profile Header Filter Bar**

### ProfileFilterView ë¥¼ ë§Œë“¤ê³  ì´ë¥¼ ProfileHeader ì— ì˜¬ë¦°ë‹¤

- ì•„ë˜ì²˜ëŸ¼ ê°€ëŠ¥í•˜ë©´ ì…€ì´ ë”± 3ê°œê°€ ë“¤ì–´ê°€ë„¤?

```swift
extension ProfileFilterView: UICollectionViewDelegateFlowLayout {
    func collectionView(_ collectionView: UICollectionView, layout collectionViewLayout: UICollectionViewLayout, sizeForItemAt indexPath: IndexPath) -> CGSize {
        return CGSize(width: frame.width / 3, height: frame.height)
    }
    
    func collectionView(_ collectionView: UICollectionView, layout collectionViewLayout: UICollectionViewLayout, minimumInteritemSpacingForSectionAt section: Int) -> CGFloat {
        return 0
    }
}
```

### ProfileFilterView ì— ë„£ì„ ProfileFilterCell ì„ ë§Œë“¤ì

- `**isSelected` ë¶€ë¶„ ë§¤ìš° ì‹ ê¸°í•˜ë‹¤â€¦**

```swift
class ProfileFilterCell: UICollectionViewCell {
    
    private let titleLabel = UILabel().then {
        $0.text = "Hello"
        $0.textColor = .lightGray
        $0.font = UIFont.systemFont(ofSize: 14)
    }
    
    override var isSelected: Bool {
        didSet {
            titleLabel.font = isSelected ? UIFont.boldSystemFont(ofSize: 16) : UIFont.systemFont(ofSize: 14)
            titleLabel.textColor = isSelected ? .twitterBlue : .lightGray
        }
    }
    
    override init(frame: CGRect) {
        super.init(frame: frame)
        
        addSubview(titleLabel)
        titleLabel.snp.makeConstraints {
            $0.centerX.centerY.equalToSuperview()
        }
    }
}
```

# **42. Filter Bar Selection Animation**

<aside>
ğŸ’¡ **ëª©í‘œ - ProfileFilterView(ìì‹) ì˜ Select ë¥¼ ê°ì§€í•´ì„œ ProfileHeader(ë¶€ëª¨) ì˜ UIë¥¼ ë³€ê²½ì‹œì¼œë¼**

</aside>

### ProfileFilterView

```swift
protocol ProfileFilterViewDelegate: AnyObject {
    func filterView(_ view: ProfileFilterView, didSelect indexPath: IndexPath)
}

class ProfileFilterView: UIView {
    weak var delegate: ProfileFilterViewDelegate?
} 

extension ProfileFilterView: UICollectionViewDelegate {
    func collectionView(_ collectionView: UICollectionView, didSelectItemAt indexPath: IndexPath) {
        delegate?.filterView(self, didSelect: indexPath)
    }
}
```

### ProfileHeader

- **ì§„ì§œ ì–´ë µë‹¤â€¦**

```swift
class ProfileHeader: UICollectionReusableView {
    override init(frame: CGRect) {
        super.init(frame: frame)
        filterBar.delegate = self
}

extension ProfileHeader: ProfileFilterViewDelegate {
    func filterView(_ view: ProfileFilterView, didSelect indexPath: IndexPath) {
        guard let cell = view.collectionView.cellForItem(at: indexPath) as? ProfileFilterCell else { return }
        let xposition = cell.frame.origin.x
        UIView.animate(withDuration: 0.3) {
            self.underlineView.frame.origin.x = xposition
        }
    }
}
```

# **43. Profile Filters Data Model**

<aside>
ğŸ’¡ **ProfileFilterCell ì— í…ìŠ¤íŠ¸ ë„£ê¸° + ìµœì´ˆì˜ Cell ìë™ ì„ íƒ**

</aside>

### ProfileHeaderViewModel - ProfileFilterOptions

```swift
enum ProfileFilterOptions: Int, CaseIterable {
    case tweets
    case replies
    case likes
    
    var description: String {
        switch self {
        case .tweets: return "Tweets"
        case .replies: return "Tweets & Replies"
        case .likes: return "Likes"
        }
    }
}
```

```swift
// ProfileFilterView

func collectionView(_ collectionView: UICollectionView, cellForItemAt indexPath: IndexPath) -> UICollectionViewCell {
    let cell = collectionView.dequeueReusableCell(withReuseIdentifier: reuseIdentifier, for: indexPath) as! ProfileFilterCell
    let option = ProfileFilterOptions(rawValue: indexPath.row)
    cell.option = option
    return cell
}
```

### ìµœì´ˆì˜ Cell ìë™ ì„ íƒ

```swift
// ProfileFilterView

let selectedIndexPath = IndexPath(row: 0, section: 0)
collectionView.selectItem(at: selectedIndexPath, animated: true, scrollPosition: .left
```

d
